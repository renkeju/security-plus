=====================================
课题F：撤销证书
=====================================

你可能偶尔会想要安全实体在指定的时间段内停止使用证书。为此，你必须撤销证书，这就是本章课题覆盖的内容。

证书撤销
---------------

证书可以在到期之前被撤销，其原因如下：

* 证书所有者的私钥已被泄露或丢失。
* 证书是通过欺诈手段获得的。
* 证书已被另一个证书取代。
* 证书持有者不再受信任。这种情况可能是正常的，如员工离开公司，也可能是由于系统入侵，如从属CA受到攻击。

受损CA
^^^^^^^^^^

不再受信任CA的一个例子是一个叫做DigNotar的前证书颁发机构。2011年，荷兰政府透露DigNotar已被黑客攻击，黑客为CIA和英国军情六处等机构授予了至少500张欺骗性证书。随后，荷兰政府采取措施关闭了被盗用的CA，并撤销了其中许多证书。

证书撤销列表
-------------------------

证书撤销列表[certificate revocation list（CRL）]是在到期日期之前被撤销的证书列表。每个CA都有自己的CRL，可以通过网络操作系统或网站的目录服务进行访问。CRL通常包含请求者的名称，请求ID号码，证书被撤销的原因以及其他相关信息。

许多软件程序（如电子邮件应用程序和Web浏览器）会在接收证书之前检查CRL以查看证书的状态，并拒绝被撤销或被暂停的证书。但是，CRL的使用不是强制性的，因此检查时可能会无法使用。

在线证书状态协议
---------------------------------

在线证书状态协议[Online Certificate Status Protocol（OCSP）]是一个基于HTTP的CRL替代方案，用于动态检查被撤销证书的序列号。OCSP服务器（也称为响应者）接收检查特定证书状态的请求。响应者使用证书的序列号在CA数据库中进行搜索。然后服务器将证书的状态发送给请求者。

相比CRL，使用OCSP的主要优点是可以降低开销。针对特定证书请求的OCSP响应包含的数据少于整个撤销列表，这使客户端的网络都能从中受益。但是，由于OCSP默认不会对这些标准HTTP传输进行加密，因此攻击者可能可以在OCSP处理过程中搜集到在特定时间使用特定证书的网络资源。

OCSP装订
-----------------

在标准的OCSP方案中，客户端承担了与CA联系的责任，以便能够验证证书的状态。OCSP装订（OCSP stapling）将这项责任转移给出示证书的Web服务器。Web服务器以特定的时间间隔查询OCSP服务器，OCSP服务器通过提供一个带时间戳的数字签名来响应。Web服务器将此签名响应附加到与客户端的SSL/TLS握手中，以便客户端可以验证证书的状态。

