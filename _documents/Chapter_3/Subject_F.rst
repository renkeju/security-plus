=================================
课题F：确定无线威胁
=================================

在上一章课题中，你已经确定了可能会影响信息系统的几种基于网络的攻击。现在你需要集中精力学习可能引起内部系统损害的无线威胁和漏洞。无线网络无处不在，因此防止设备中的无线漏洞时保护敏感数据不受未授权访问的关键。

现在，无线网络迅速成为了企业中的常态。大多数组织既有有线网络，也有供员工在移动中访问设施的无线网络。理解潜在的威胁和漏洞能使你成功地保护组织信息系统基础架构中地无线部分。

欺骗访问点
--------------------

欺骗访问点（rogue access point）是指企业或私有网络中的未授权无线访问点。欺骗访问点可能会对组织地数据造成极其严重地损害。它们不会被轻易检测到，并且可以通过合适的设备使未授权用户访问私有网络。欺骗访问点可以实现中间人攻击并访问私密信息。组织应当实施安装IDS等技术手段，持续监控系统，进行自我保护，避免受到此类攻击。

双面恶魔
------------------

在无线网络环境中，双面恶魔（evil twin）访问点会欺骗用户相信无线网络中的这个访问点是合法的。虽然企业和私有网络中都能安装双面恶魔访问点，但通常都是在公共Wi-Fi热点中发现它们，用户不会像在公司网络中一样直接自动连接这些热点，而是会从列表中选择可用玩咯。恶意用户可以使用具备网络共享功能的智能手机等基本设备设置一个类似的访问点。双面恶魔可能比欺骗访问点更加危险，因为用户会误以为这个无线信号是真实可靠的，将有效访问点和一个使用相同或类似名称的访问点区分开来是十分困难的。

.. note:: 合法WAP和双面恶魔的SSID不需要完全相同，它们通常是相似的，但不完全匹配。

干扰
----------

在无线网络中，干扰（jamming）也叫冲突（interference），是指无线电波扰乱802.11无线信号的一种攻击。经常发生在家庭环境中，因为里面有许多运行在无线网络相近带宽中的电子设备，如微波炉。发生这种情况时，会导致 802.11 信号在传输之前等待，这个等待时间有时时不确定的。攻击者可以使用无线电收发器干扰传输，注入干扰数据包，中断网络之间的正常流量。

蓝牙劫持
---------------

蓝牙劫持（Bluejacking）是指攻击者从智能手机、移动手机、平板电脑、笔记本电脑等设备向其他启用蓝牙（Bluetooth）功能的设备中发送不想要的蓝牙信号的方式。由于蓝牙的传输距离相对较短，因此蓝牙劫持往往在近距离范围内。随着现在可用技术的提高发展，攻击者可以发送未经请求的消息、图片和视频。这种信号可能会导致许多不同的威胁。它们会导致设备故障，甚至传播病毒，如特洛伊木马。用户应当拒绝匿名接触，并将移动设备配置成不可发现的模式。

蓝牙设备等级
^^^^^^^^^^^^^^^^^^^^

从蓝牙技术的开创开始，它从低功率，极近距离传输的特征逐渐演化为三种不同的设备等级。

.. csv-table:: 蓝牙设备等级
    :header: "蓝牙设备的等级", "传输功率", "预计传输范围"
    :widths: 5 5 10

    "3类", "1毫瓦(mW)", "长达10米（32.8英尺）"
    "2类", "2.5mW", "长达10米（32.8英尺）"
    "1类", "100(mW)", "长达100米（328英尺）"

蓝牙监听
----------------

蓝牙窃听（Bluesnarfing）是指攻击者在328英尺的蓝牙传输限制范围之内，获取使用蓝牙连接的无线设备中未授权信息的访问权限。与蓝牙劫持不同，通过蓝牙窃听访问智能手机、平板电脑、移动手机、笔记本电脑等无线设备可能会导致私密信息被利用，包括电子邮件信息、联系人信息、日历条目、图片、视频以及存储在设备中的任何数据。

近场通讯攻击
--------------------

近场通讯（Near Field Communication/NFC）是指智能手机和平板电脑等移动设备之间在极近距离内进行的一种标准通讯，通常是通过接触或在仅相隔几英寸的距离内进行。NFC经常被用于当面交易或数据交换。例如，Android Pay、Apple Pay、Samsung Pay等都使用NFC来与支付终端进行通讯，完成非接触支付。

除了需要在更小范围内进行操作，NFC在传输数据的数量方面也比蓝牙更加有限，但通讯速度更快，也更容易被激活。

虽然有着严格的物理距离方面的限制要求，但是NFC仍然容易受到某些攻击的影响。

* 例如，某个天线配置能够收到来自几英尺外的NFC发出的RF信号，这样，攻击者就能从更舒适的距离窃听数据。
* 攻击者可能还可以通过一种类似拒绝服务攻击的方式破坏传输中的数据——用过量的RF信号淹没这个区域来破坏传输。
* 如果有人丢失了一个NFC设备或被盗，并且这个设备也没有额外的安全验证层，那么任何人都能以恶意的方式使用这个设备。

无线电射频识别系统攻击
-------------------------------

无线电射频识别（Radio-Requency Identification/RFID）这种技术使用电磁场来自动识别并跟踪被附加在选定对象上存储了有关对象信息的标签或芯片。RFID系统包括一个标签（其中有一个嵌入式发射器和接收器）和一个读取器。由于实施的简便性，这种技术的使用得到了大幅的增加，并且包含了许多不同的应用，如：

* 存货管理和跟踪
* 人与动物的识别与跟踪
* 非接触支付
* 智能卡

当然，它们无所不在的特征也使它们成为了攻击者的潜在目标。一种RFID攻击就是盗用（skimming），攻击者使用一个欺骗性的RFID读取器来读取非接触银行卡发出的信号。

战争驾驶、战争漫步和开战标记
----------------------------------

战争驾驶（war driving）或战争漫步（war walking）是指使用智能手机、平板电脑、移动电话或笔记本电脑等无线跟踪设备搜索无线网络实例的行为。它会确定可以加以利用的无线访问点位置，来获取未授权的互联网访问，可能的话还会窃取数据。

开战标记（war chalking）是指使用符号标记人行道或墙壁，以表明附近无线网络的存在情况和状态。例如，两个半圆形背靠背叠加表示一个开放节点，圆形表示闭合节点，一个W位于一个圆形内部表示WEP节点。节点的SSID和其他信息可能也包含在标志中。

战争驾驶的攻击
^^^^^^^^^^^^^^^^^^^^^

有一些常用工具可以在战争驾驶和开战标记中使用：

* NetStumbler
* Kismet
* Aircrack

数据包嗅探
-------------------------

数据包嗅探（Packet sniffing）可以成为无线网络中的一种攻击手段，攻击者使用协议分析器捕获数据并寄存数据流，最终将允许攻击者分析包含在捕获数据包中的数据。攻击者可以使用从分析中收集到的数据在网络中发动更有效的攻击。从有益的方面看，数据包嗅探还能帮助组织监控自己的网络，防御攻击者入侵。

数据包嗅探还可能发生在有线网络中，但是由于可管理式交换机的出现，这种现象的成功率普遍降低了。

IV攻击
--------------

在加密领域中，初始化向量（initialization vector/IV）是一种被添加到密钥上的数字，它会处于持续变化中，以防止相同的文本在加密后产生完全一样的密文。这种方法使黑客更难解密重复出现的被加密信息。IV攻击（IV attack）使攻击者能够预测或控制IV，以便避开这种效应。如果IV的的位元长度相对较短，被破解的可能性就越大。比如，现代系统通常能够毫不费力地破解24位的IV。

无线重放攻击
-------------------

在弱加密或无加密的无线网中，攻击者可能会发现捕获数据包进行重放以操控数据流变得更加容易。重放攻击还能与IV攻击结合使用，成功地破解弱加密。

WEP和WAP攻击
--------------------

有线等效保密（Wired Equivalent Privacy/WEP）算法使用于保护无线网络地最早算法。这种数据加密方法是为了匹配当时的有线连接安全性。WEP有64位，128位和256位的密钥长度。但是由于它使用流密码来加密数据，因此需要依赖一个IV来将文本的相同字符串随机化。如果使用24位的IV长度，那么在IV攻击中，IV的值可能被预测出来，是WEP变得极其脆弱。实际上，一些可用软件能在标准消费级别的硬件上，在几分钟内破解WEP加密。由于其脆弱性，2004年时WEP就受到了反对并不在使用。

WEP以被安全的多的无线保护访问（Wi-Fi Protected Access/WPA）协议极其后续协议WPA2所替代。与WEP不同的是，WPA为每个被发送的数据包生成一个128位的密钥，防止加密信息被轻易破解。虽然WPA使用相同的RC4流密码，但是WPA2使用了更加安全的AES块密码来进行加密。但即使安全性得到了加固，这两种WPA协议仍然容易受到攻击。尤其是对于使用弱密码保护WPA无线网络的用户，他们的网络在密码暴力破解的攻击之下仍不堪一击。WPA中另一个潜在的弱点就是允许攻击者在无线数据流中注入恶意数据包。

当下，WPA2被认为是最安全的无线加密协议，并应当取代WPA使用。

WPS攻击
------------------

无线保护设置（Wi-Fi Protected Setup/WPS）功能通过添加更多方法来验证密钥生成，实现无线加密安全性的增强，防止用户选择弱密码。其中一种方式就是必须输入物理无线设备上显示的8位PIN码，才能登入网络。但是由于WPS检查每个PIN码的一半，只需要几千次猜测就能成功地破解PIN码。这项工作在几个小时内就能完成。

许多无线设备中默认开启WPS功能。你应当禁用这项功能防止潜在的安全漏洞，但要记住一些设备不允许禁用这项功能。但你可以尝试在物理层面上保护特定设备，是用户不能接触到WPS按钮。

无线分离攻击
---------------------

连接无线设备到WAP中不仅需要设备通过认证，还要与WAP相关联。可以通过交换802.11管理帧建立连接并允许网络访问实现这一功能。如果设备移动到WAP的有效范围之外，或WAP发送一个分离帧终止连接，就会发生分离现象。

无线分离攻击（wireless disassociation attack）是一种无线攻击，攻击者向目标设备发送一个虚假的分离帧，使之看起来好像来自WAP。这种行为使目标设备尝试与WAP重新获得连接。通过持续不断地发送分离帧，攻击者就能引起DoS。

